# Ranger3 API Integration & Project Structure

## 1. Overview
This document describes how to integrate Mas with Ranger3 MCP via REST API and defines a compatible, future-proof project structure to support advanced agent workflows.

---

## 2. Project Structure: Project → Plan → Agent → Deliverable

Every project is a directory with the following hierarchy:

```
workspace/
└── projects/
    └── <project_name>/
        ├── plan.json           # Plan definition (one per project)
        ├── agents/
        │   └── <agent_id>.json # Agent configs (one or more)
        ├── assets/
        │   ├── system_prompt.txt
        │   └── ...             # Other input files/assets
        ├── deliverables/
        │   └── ...             # Output files, generated work
        ├── manifest.json       # Manifest of all work, assets, deliverables, and memory
        └── memory/
            └── ...             # System/plan memory files
```

- **Every project has one plan** (`plan.json`).
- **Every plan has one or more agents** (in `agents/`).
- **Assets** are inputs (e.g., system prompts, datasets) in `assets/`.
- **Deliverables** are outputs in `deliverables/`.
- **Manifest** (`manifest.json`) tracks all files, work, and memory generated by the plan.
- **Memory** stores persistent memory generated by the plan and agents.

---

## 3. Ranger3 REST API Integration

### 3.1. Authentication
- All requests require `Authorization: Bearer <MAS_SERVER_API_KEY>` in the header.
- API base: `http://<host>:<port>/api/v1/`

### 3.2. Key Endpoints

#### Workspace Management
- `GET /workspace/list?path=...` — List directory contents
- `POST /workspace/read` — Read file content
- `POST /workspace/write` — Write file content
- `POST /workspace/range-save` — Edit file range

#### Git Operations
- `GET /git/status` — Get git status
- `GET /git/history` — Get commit history
- `POST /git/diff` — Get file/repo diff

#### Shell Commands
- `POST /shell/exec` — Run shell command (sync)
- `POST /shell/exec-async` — Run shell command (async)
- `GET /shell/status/{job_id}` — Check async job
- `POST /shell/kill/{job_id}` — Kill async job

#### LSP Operations
- `GET /lsp/servers` — List language servers
- `POST /lsp/servers/{language}/install` — Install LSP
- `POST /lsp/diagnose` — Run diagnostics
- `POST /lsp/execute` — Run LSP command

### 3.3. Example Integration Flows

#### Project Initialization
1. Create a new project directory under `workspace/projects/<project_name>/`.
2. Upload or define `plan.json`, agent configs, and assets.
3. Use `/workspace/write` to create files.
4. Use `/workspace/list` to verify structure.

#### Agent Execution & Deliverables
1. Agents read assets and config from their project subfolders.
2. Agents write deliverables to `deliverables/` using `/workspace/write`.
3. Manifest is updated with paths and metadata for all outputs and memory.

#### Memory Management
1. Agents store and retrieve memory in `memory/`.
2. Manifest tracks memory file locations and metadata.

#### Version Control
1. Use `/git/status`, `/git/history`, `/git/diff` for project versioning.
2. All file changes are auto-committed (if configured).

---

## 4. Manifest Specification
- `manifest.json` records:
    - All assets and deliverables (paths, types, timestamps)
    - Agent and plan configs
    - Memory files
    - Execution logs/metadata
    - Any system messages or errors

---

## 5. Security & Permissions
- All API access must be authenticated.
- Restrict file operations to within the project workspace root.

---

## 6. Example Project Tree

```
workspace/
└── projects/
    └── my_project/
        ├── plan.json
        ├── agents/
        │   ├── agent1.json
        │   └── agent2.json
        ├── assets/
        │   └── system_prompt.txt
        ├── deliverables/
        │   └── output.txt
        ├── manifest.json
        └── memory/
            └── agent1_mem.json
```

---

## 7. Notes
- All project, plan, and agent operations should be exposed via REST endpoints for automation.
- Future expansion: add GraphQL for richer queries/mutations if needed.

---

# End of Ranger3-API-Integration.md
